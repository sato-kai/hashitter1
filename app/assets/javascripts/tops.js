$(document).on("turbolinks:load",function(){

  function appendSlimTops(){
    var topsHtml = '';
    topsHtml = `<div id="tops">
                  <svg version="1.1" viewBox="0 0 210 297" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg">
                    <g stroke="#000" stroke-width="3">
                      <path d="m84.667 177.94c15.255 18.068 29.123 17.226 42.333 0 6.3998-2.538 13.165 0.95404 21.167 13.229l8.9958 31.75-19.579 1e-5v-10.583 42.333h-63.5v-42.333l1e-6 10.583-19.579-1e-5 8.9958-31.75c8.5574-13.04 14.993-15.287 21.167-13.229z"/>
                    </g>
                  </svg>
                </div>`;
    $('.tops').append(topsHtml);
  }
  function appendTops1(){
    var topsHtml = '';
    topsHtml = `<div id="tops">
                  <div id="parker">
                    <svg version="1.1" viewBox="0 0 210 297" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg">
                      <g stroke="#000">
                      <path d="m105.83 183.76c15.875-3.175 21.167-3.175 21.167-8.4667 6.0592-0.13193 10.583 0 10.583 5.2917l10.583 5.2917c3.6668 12.488 7.7963 25.008 4.7625 37.042l-2.3673 21.167h-12.672v10.583h-65.171v-10.583h-12.672l-2.3673-21.167c-1.5469-13.77 2.6926-25.179 5.8208-37.042l10.583-5.2917c0-5.2917 2.608-6.2284 10.583-5.2917 0 5.2917 5.2917 5.2917 21.167 8.4667z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.92"/>
                      </g>
                      <g stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">
                        <path d="m137.58 204.4v39.688"></path>
                        <path d="m73.025 204.4v39.688"></path>
                        <path d="m74.083 180.58c5.2917 10.583 21.167 2.6458 31.75 2.6458 10.583 1e-5 26.458 7.9375 31.75-2.6458" fill="none"></path>
                      </g>
                      <div id='line'>
                        <svg version="1.1" viewBox="0 0 210 297" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg">
                          <path d="m74.612 212.33 10.583 10.583-10.583 21.167"></path>
                          <path d="m136 212.33-10.583 10.583 10.583 21.167"></path>
                          <path xmlns="http://www.w3.org/2000/svg" d="m105.83 183.23v68.792" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/>
                        </svg>
                      </div>
                    </svg>
                  </div>
                </div>`;
    $('.tops').append(topsHtml);
  }
  function appendTops2(){
    var topsHtml = '';
    topsHtml = `<div id="tops">
                  <div id="parker">
                    <svg version="1.1" viewBox="0 0 210 297" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg">
                      <g stroke="#000">
                      <path d="m121.18 185.87c5.2918-5.2918 5.2918-10.584 10.584-10.584 6.0592-0.13193 26.459 10.584 5.8134 9.5307l10.054-6e-5c3.6668 12.488 8.3255 26.066 5.2917 38.1l-2.3673 21.167h-12.672v10.583h-65.171v-10.583h-12.672l-2.3673-21.167c-1.5469-13.77 2.6926-26.237 5.8208-38.1l10.054 0.52924c-11.635 0.52361-15.869-4.7682 5.2985-10.06 5.2918 0 5.2918 5.2918 10.584 10.584l15.875 21.167z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.92"/>
                      </g>
                      <g stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">
                        <path d="m137.58 204.4v39.688"></path>
                        <path d="m73.025 204.4v39.688"></path>
                        <path d="m73.554 185.34c5.2917 10.583 21.696 20.638 32.279 20.638 10.583 1e-5 26.458-10.054 31.75-20.638" fill="none"></path>
                      </g>
                      <div class='black' id='line'>
                        <svg version="1.1" viewBox="0 0 210 297" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg">
                          <path d="m74.612 212.33 10.583 10.583-10.583 21.167"></path>
                          <path d="m136 212.33-10.583 10.583 10.583 21.167"></path>
                          <path d="m105.83 206.51v45.508" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        </svg>
                      </div>
                    </svg>
                  </div>
                </div>`;
    $('.tops').append(topsHtml);
  }

  $('input[name="user[avatar_attributes][tops]"]:radio').change(function(){
    var topsStyle = $('input[name="user[avatar_attributes][tops]"]:checked').val();
    var color = $('#tops-color-field').val();
    if (topsStyle == 'slim'){
      $('#tops').remove();
      appendSlimTops();
      $('#tops').css('fill', color)
    }else if (topsStyle == 'tops1'){
      $('#tops').remove();
      appendTops1();
      $('#tops').css('fill', color)
    }else {
      $('#tops').remove();
      appendTops2();
      $('#tops').css('fill', color)
    };
    
  });

  $('input[name="user[avatar_attributes][tops_color]"]').change(function(){
    var color = $(this).val();
    $('#tops').css('fill', color);
    $('#hidden-tops-color').val(color);
    $('#tops-color-field').val(color)
  });

});